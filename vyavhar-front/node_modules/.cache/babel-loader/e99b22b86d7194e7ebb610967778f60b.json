{"ast":null,"code":"import _asyncToGenerator from\"/media/utkarsh/Utkarsh/Utkarsh/Utkarsh's docs/My work/JS/MERN/vyavhar/vyavhar-front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/media/utkarsh/Utkarsh/Utkarsh/Utkarsh's docs/My work/JS/MERN/vyavhar/vyavhar-front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/media/utkarsh/Utkarsh/Utkarsh/Utkarsh's docs/My work/JS/MERN/vyavhar/vyavhar-front/node_modules/@babel/runtime/regenerator/index.js\";import{React,useState,useEffect,useContext}from'react';import'./post.css';import{MoreVert}from\"@material-ui/icons\";import{format}from'timeago.js';import{Link}from'react-router-dom';import{AuthContext}from'../../context/AuthContext';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Post(_ref){var post=_ref.post;var _useState=useState(post.likes.length),_useState2=_slicedToArray(_useState,2),like=_useState2[0],setLike=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isliked=_useState4[0],setIsLiked=_useState4[1];var PF=process.env.REACT_APP_PUBLIC_FOLDER;var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var _useContext=useContext(AuthContext),currentUser=_useContext.user;useEffect(function(){setIsLiked(post.likes.includes(currentUser._id));},[currentUser._id,post.likes]);useEffect(function(){var fetchUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/users?userId=\".concat(post.userId));case 2:res=_context.sent;setUser(res.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function fetchUser(){return _ref2.apply(this,arguments);};}();fetchUser();},[post.userId]);var deletepost=function deletepost(){try{console.log(currentUser._id);axios.delete('/posts/'+post._id,{data:{userId:currentUser._id}}).then(function(){return window.location.reload();});}catch(e){console.log(e);}};var likehander=function likehander(){try{axios.put('/posts/'+post._id+'/like',{userId:currentUser._id});}catch(e){console.log(e);}setIsLiked(!isliked);setLike(isliked?like-1:like+1);};return/*#__PURE__*/_jsx(\"div\",{className:\"post\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"postWrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postTop\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postTopLeft\",children:[/*#__PURE__*/_jsx(Link,{to:\"profile/\".concat(user.username),children:/*#__PURE__*/_jsx(\"img\",{className:\"postProfileImg\",src:user.profilePicture?PF+user.profilePicture:PF+\"no_avatar/image_proxy.jpeg\",alt:\"\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"postUsername\",children:user.username}),/*#__PURE__*/_jsx(\"span\",{className:\"postDate\",children:format(post.createdAt)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"postTopRight\",children:/*#__PURE__*/_jsx(MoreVert,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"postCenter\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"postText\",children:post.desc}),post.img&&(post.img.split('.')[1]==='m4v'||post.img.split('.')[1]==='webm'||post.img.split('.')[1]==='mp4')?/*#__PURE__*/_jsx(\"video\",{src:PF+post.img,width:\"750\",height:\"500\",controls:true}):/*#__PURE__*/_jsx(\"img\",{className:\"postImg\",src:PF+post.img,alt:\"\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"postBottom\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"postBottomLeft\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"likeIcon\",src:PF+\"like.png\",onClick:likehander,alt:\"\"}),/*#__PURE__*/_jsx(\"img\",{className:\"likeIcon\",src:PF+\"heart.png\",alt:\"\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"postLikeCounter\",children:[like,\" people like it\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"postBottomRight\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"postCommentText\",children:[post.comment,\" comments\"]})}),user._id===currentUser._id?/*#__PURE__*/_jsx(\"button\",{onClick:deletepost,children:\"Delete\"}):/*#__PURE__*/_jsx(\"p\",{})]})]})});}","map":{"version":3,"sources":["/media/utkarsh/Utkarsh/Utkarsh/Utkarsh's docs/My work/JS/MERN/vyavhar/vyavhar-front/src/components/post/Post.jsx"],"names":["React","useState","useEffect","useContext","MoreVert","format","Link","AuthContext","axios","Post","post","likes","length","like","setLike","isliked","setIsLiked","PF","process","env","REACT_APP_PUBLIC_FOLDER","user","setUser","currentUser","includes","_id","fetchUser","get","userId","res","data","deletepost","console","log","delete","then","window","location","reload","e","likehander","put","username","profilePicture","createdAt","desc","img","split","comment"],"mappings":"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","sourcesContent":["import { React , useState , useEffect,useContext } from 'react'\nimport './post.css'\nimport { MoreVert} from \"@material-ui/icons\";\nimport {format} from 'timeago.js'\nimport {Link} from 'react-router-dom'\nimport {AuthContext} from '../../context/AuthContext'\n\nimport axios from 'axios'\n\n\n\n\nexport default function Post({post}) {\n\n  const [like,setLike] = useState(post.likes.length)\n  const [isliked,setIsLiked] = useState(false)\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER\n  const [user, setUser] = useState({});\n  const {user:currentUser} = useContext(AuthContext)\n  useEffect(() => {\n    setIsLiked(post.likes.includes(currentUser._id))\n  }, [currentUser._id,post.likes])\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      const res = await axios.get( `/users?userId=${post.userId}`);\n      setUser(res.data)\n    }\n    fetchUser();\n\n  },[post.userId])\n\n  const deletepost = () => {\n\n    try{\n      console.log(currentUser._id)\n      axios.delete('/posts/'+post._id,{data:{userId:currentUser._id}}).then(()=>(window.location.reload() )) \n \n    }catch(e){\n      console.log(e)\n    }\n  }\n  const likehander = () => {\n    try{\n      axios.put('/posts/'+post._id+'/like',{userId:currentUser._id})\n\n    }catch(e){\n      console.log(e)\n    }\n    setIsLiked(!isliked)\n    setLike(isliked?like-1:like+1)\n  }\n  return (\n\t\t <div className=\"post\">\n      <div className=\"postWrapper\">\n        <div className=\"postTop\">\n          <div className=\"postTopLeft\">\n          <Link to={`profile/${user.username}`}>\n            <img\n              className=\"postProfileImg\"\n              src={user.profilePicture ? PF+user.profilePicture : PF+\"no_avatar/image_proxy.jpeg\"}\n              alt=\"\"\n            />\n            </Link>\n            <span className=\"postUsername\">\n              {user.username}\n            </span>\n            \n            <span className=\"postDate\">{format(post.createdAt)}</span>\n          </div>\n          <div className=\"postTopRight\">\n            <MoreVert />\n          </div>\n        </div>\n        <div className=\"postCenter\">\n          <span className=\"postText\">{post.desc}</span>\n          {\n            (post.img&&((post.img).split('.')[1] === 'm4v' || (post.img).split('.')[1] === 'webm' || (post.img).split('.')[1] === 'mp4')) ?\n                <video src={PF+post.img} width=\"750\" height=\"500\" controls />\n                :\n                <img className=\"postImg\" src={PF+post.img} alt=\"\" />\n            \n          }\n          \n          \n        </div>\n        <div className=\"postBottom\">\n          <div className=\"postBottomLeft\">\n            <img className=\"likeIcon\" src={PF+\"like.png\"} onClick={likehander} alt=\"\" />\n            <img className=\"likeIcon\" src={PF+\"heart.png\"}  alt=\"\" />\n            <span className=\"postLikeCounter\" >{like} people like it</span>\n          </div>\n          <div className=\"postBottomRight\">\n            <span className=\"postCommentText\">{post.comment} comments</span>\n          </div>\n          {user._id === currentUser._id?<button onClick={deletepost}>Delete</button>:<p></p>}\n          \n        </div>\n      </div>\n    </div>\n\t)\n}"]},"metadata":{},"sourceType":"module"}